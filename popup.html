<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Idealista Property Manager</title>
    <link rel="stylesheet" href="popup.css">
</head>
<body>
    <div class="popup-container">
        <header class="popup-header">
            <h1>ğŸ  Property Manager</h1>
            <div class="header-actions">
                <button id="debugBtn" class="btn btn-secondary">ğŸ› Debug</button>
                <button id="exportBtn" class="btn btn-secondary">ğŸ“Š Exportar</button>
                <button id="clearBtn" class="btn btn-danger">ğŸ—‘ï¸ Limpiar</button>
            </div>
        </header>

        <div class="stats-bar">
            <span id="totalProperties">0 propiedades</span>
            <span id="avgScore" class="clickable-score">Score: 0</span>
            <span id="bestPrice">Mejor: 0â‚¬</span>
        </div>

        <div class="properties-container">
            <div id="propertiesList" class="properties-list">
                <!-- Properties will be inserted here -->
            </div>
        </div>

        <div id="emptyState" class="empty-state">
            <div class="empty-icon">ğŸ </div>
            <h3>No hay propiedades guardadas</h3>
            <p>Navega a una propiedad de Idealista y haz clic en "Agregar" para comenzar</p>
        </div>
    </div>

    <!-- Scoring Explanation Modal -->
    <div id="scoringModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>ğŸ“Š CÃ¡lculo del Score</h2>
                <span class="close" id="closeModal">&times;</span>
            </div>
            <div class="modal-body">
                <div class="scoring-overview">
                    <h3>Algoritmo de PuntuaciÃ³n Objetiva</h3>
                    <p>El score se calcula usando estadÃ­sticas del mercado inmobiliario espaÃ±ol, con pesos basados en la importancia real de cada factor para el valor de una propiedad.</p>
                </div>
                
                <div class="scoring-breakdown">
                    <h4>Desglose por CategorÃ­as:</h4>
                    <div id="scoringDetails">
                        <!-- Scoring details will be populated here -->
                    </div>
                </div>

                <div class="scoring-stats">
                    <h4>ğŸ“ˆ EstadÃ­sticas del Mercado (Madrid):</h4>
                    <ul>
                        <li><strong>Precio promedio:</strong> 750â‚¬/mes</li>
                        <li><strong>Precio por mÂ²:</strong> 12â‚¬/mÂ²</li>
                        <li><strong>TamaÃ±o promedio:</strong> 65mÂ²</li>
                        <li><strong>Habitaciones promedio:</strong> 2.5</li>
                    </ul>
                </div>

                <div class="scoring-weights">
                    <h4>âš–ï¸ DistribuciÃ³n de Pesos (Basada en AnÃ¡lisis de Mercado):</h4>
                    <div class="weight-chart">
                        <div class="weight-item">
                            <span class="weight-label">Precio (30%)</span>
                            <div class="weight-bar">
                                <div class="weight-fill" style="width: 30%"></div>
                            </div>
                        </div>
                        <div class="weight-item">
                            <span class="weight-label">TamaÃ±o (20%)</span>
                            <div class="weight-bar">
                                <div class="weight-fill" style="width: 20%"></div>
                            </div>
                        </div>
                        <div class="weight-item">
                            <span class="weight-label">Habitaciones (15%)</span>
                            <div class="weight-bar">
                                <div class="weight-fill" style="width: 15%"></div>
                            </div>
                        </div>
                        <div class="weight-item">
                            <span class="weight-label">CaracterÃ­sticas (15%)</span>
                            <div class="weight-bar">
                                <div class="weight-fill" style="width: 15%"></div>
                            </div>
                        </div>
                        <div class="weight-item">
                            <span class="weight-label">Precio/mÂ² (10%)</span>
                            <div class="weight-bar">
                                <div class="weight-fill" style="width: 10%"></div>
                            </div>
                        </div>
                        <div class="weight-item">
                            <span class="weight-label">BaÃ±os (10%)</span>
                            <div class="weight-bar">
                                <div class="weight-fill" style="width: 10%"></div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="popup.js"></script>
</body>
</html>
